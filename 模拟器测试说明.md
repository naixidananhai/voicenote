# Android 模拟器测试说明

## 方案 1: 使用 Android Studio 模拟器（推荐）

### 1. 打开 Android Studio
- 启动 Android Studio
- 点击右上角的 "Device Manager" 图标

### 2. 创建虚拟设备
如果没有现有的模拟器：
1. 点击 "Create Device"
2. 选择设备类型（推荐：Pixel 5）
3. 选择系统镜像：**Android 14.0 (API 34)** - Google Play
4. 点击 "Next" 和 "Finish"

### 3. 启动模拟器
- 在 Device Manager 中点击模拟器旁边的 ▶️ 按钮
- 等待模拟器完全启动（显示主屏幕）

### 4. 安装 APK
有两种方法：

**方法 A: 拖放安装**
- 直接将 `app\build\outputs\apk\debug\app-debug.apk` 拖到模拟器窗口
- 等待安装完成

**方法 B: 命令行安装**
```powershell
& "C:\Users\yangyayuan\AppData\Local\Android\Sdk\platform-tools\adb.exe" install -r "app\build\outputs\apk\debug\app-debug.apk"
```

## 方案 2: 使用真实 Android 设备

### 1. 启用开发者选项
1. 打开手机 "设置"
2. 找到 "关于手机"
3. 连续点击 "版本号" 7次
4. 返回设置，找到 "开发者选项"
5. 启用 "USB 调试"

### 2. 连接手机到电脑
- 使用 USB 数据线连接
- 手机上会弹出 "允许 USB 调试" 提示，点击 "允许"

### 3. 验证连接
```powershell
& "C:\Users\yangyayuan\AppData\Local\Android\Sdk\platform-tools\adb.exe" devices
```
应该看到你的设备列表

### 4. 安装 APK
```powershell
& "C:\Users\yangyayuan\AppData\Local\Android\Sdk\platform-tools\adb.exe" install -r "app\build\outputs\apk\debug\app-debug.apk"
```

## 方案 3: 直接在手机上安装

### 1. 传输 APK 到手机
- 通过 USB 将 APK 文件复制到手机
- 或通过微信/QQ 发送给自己

### 2. 安装
- 在手机上找到 APK 文件
- 点击安装
- 可能需要允许 "未知来源" 安装

## 测试步骤

安装完成后，按照 `VAD测试指南.md` 进行测试：

### 1. 打开应用
- 找到 "VoiceLife 语音助手" 图标
- 点击打开

### 2. 授予权限
- 录音权限 ✅
- 通知权限 ✅
- 后台运行权限 ✅

### 3. 启动服务
- 点击 "启动服务" 按钮
- 观察日志输出

### 4. 测试录音
**静音测试（30秒）**：
- 保持安静
- 观察日志中的音频数据

**说话测试（30秒）**：
- 对着手机说话
- 观察 VAD 概率变化

### 5. 复制日志
- 点击 "📋 复制" 按钮
- 将日志发送给我分析

## 关键日志指标

查找以下日志：

### ✅ 初始化成功
```
[INFO ] [AudioRecorder] ✅ VAD检测器初始化成功
[INFO ] [AudioRecorder] ✅ 录制器初始化成功 (16kHz, MONO)
```

### 📊 音频数据（每100帧）
```
[DEBUG] [AudioRecorder] 原始音频 - Short范围: [-1234, 5678]
[DEBUG] [AudioRecorder] Float音频 - 范围: [-0.037, 0.173]
```

### 🎯 VAD 概率（每50帧）
```
[DEBUG] [AudioRecorder] VAD概率: 0.856
[DEBUG] [SileroVadEngine] VAD推理成功 - 概率: 0.856
```

### 🎤 人声检测
```
[INFO ] [AudioRecorder] 🎤 检测到人声，开始录音
```

## 常见问题

### Q: 模拟器启动很慢？
A: 第一次启动需要较长时间，请耐心等待。后续启动会快很多。

### Q: 模拟器无法启动？
A: 
1. 确保 BIOS 中启用了虚拟化（VT-x/AMD-V）
2. 关闭 Hyper-V（Windows 功能）
3. 尝试使用 ARM 镜像而不是 x86_64

### Q: APK 安装失败？
A:
1. 确保模拟器/设备已完全启动
2. 尝试先卸载旧版本
3. 检查 Android 版本是否 >= 8.0 (API 26)

### Q: 应用闪退？
A: 查看 logcat 日志：
```powershell
& "C:\Users\yangyayuan\AppData\Local\Android\Sdk\platform-tools\adb.exe" logcat | Select-String "VoiceLife"
```

## 下一步

测试完成后，请提供：
1. 完整的应用内日志（点击 "📋 复制"）
2. 测试时的操作步骤
3. 遇到的任何问题
4. 设备型号和 Android 版本

这些信息将帮助我诊断 VAD 概率为 0 的问题。
